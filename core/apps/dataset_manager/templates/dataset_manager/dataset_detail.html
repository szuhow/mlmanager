{% extends "dataset_manager/base.html" %}
{% load static %}

{% block title %}{{ dataset.name }} - Dataset Manager{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-database"></i>
                        {{ dataset.name }}
                        <span class="badge badge-{{ dataset.status|default:'secondary' }} ml-2">
                            {{ dataset.get_status_display }}
                        </span>
                    </h3>
                    <div class="card-tools">
                        <a href="{% url 'dataset_manager:dataset_list' %}" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Back to Datasets
                        </a>
                        {% if dataset.status == 'ready' %}
                        <a href="{% url 'dataset_manager:dataset_samples' dataset_id=dataset.id %}" class="btn btn-primary">
                            <i class="fas fa-eye"></i> View Samples
                        </a>
                        {% endif %}
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-8">
                            <!-- Dataset Information -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5>Dataset Information</h5>
                                </div>
                                <div class="card-body">
                                    <dl class="row">
                                        <dt class="col-sm-3">Name:</dt>
                                        <dd class="col-sm-9">{{ dataset.name }}</dd>
                                        
                                        <dt class="col-sm-3">Description:</dt>
                                        <dd class="col-sm-9">{{ dataset.description|default:"No description provided" }}</dd>
                                        
                                        <dt class="col-sm-3">Version:</dt>
                                        <dd class="col-sm-9">{{ dataset.version }}</dd>
                                        
                                        <dt class="col-sm-3">Format:</dt>
                                        <dd class="col-sm-9">{{ dataset.get_format_type_display }}</dd>
                                        
                                        <dt class="col-sm-3">Status:</dt>
                                        <dd class="col-sm-9">
                                            <span class="badge badge-{{ dataset.status|default:'secondary' }}">
                                                {{ dataset.get_status_display }}
                                            </span>
                                        </dd>
                                        
                                        <dt class="col-sm-3">Total Samples:</dt>
                                        <dd class="col-sm-9">{{ dataset.total_samples|default:"0" }}</dd>
                                        
                                        <dt class="col-sm-3">File Size:</dt>
                                        <dd class="col-sm-9">
                                            {% if dataset.file_size_bytes %}
                                                {{ dataset.file_size_bytes|filesizeformat }}
                                            {% else %}
                                                Unknown
                                            {% endif %}
                                        </dd>
                                        
                                        <dt class="col-sm-3">Original File:</dt>
                                        <dd class="col-sm-9">{{ dataset.original_filename|default:"Unknown" }}</dd>
                                        
                                        <dt class="col-sm-3">Created:</dt>
                                        <dd class="col-sm-9">{{ dataset.created_at|date:"Y-m-d H:i" }}</dd>
                                        
                                        <dt class="col-sm-3">Created by:</dt>
                                        <dd class="col-sm-9">{{ dataset.created_by.username }}</dd>
                                    </dl>
                                </div>
                            </div>
                            
                            <!-- Schema Information -->
                            {% if dataset.annotation_schema %}
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5>Annotation Schema</h5>
                                </div>
                                <div class="card-body">
                                    <dl class="row">
                                        <dt class="col-sm-3">Schema:</dt>
                                        <dd class="col-sm-9">{{ dataset.annotation_schema.name }}</dd>
                                        
                                        <dt class="col-sm-3">Type:</dt>
                                        <dd class="col-sm-9">{{ dataset.annotation_schema.get_type_display }}</dd>
                                        
                                        <dt class="col-sm-3">Description:</dt>
                                        <dd class="col-sm-9">{{ dataset.annotation_schema.description|default:"No description" }}</dd>
                                    </dl>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-4">
                            <!-- Statistics -->
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5>Statistics</h5>
                                </div>
                                <div class="card-body">
                                    <div class="info-box bg-info">
                                        <span class="info-box-icon"><i class="fas fa-images"></i></span>
                                        <div class="info-box-content">
                                            <span class="info-box-text">Total Samples</span>
                                            <span class="info-box-number">{{ dataset.total_samples|default:"0" }}</span>
                                        </div>
                                    </div>
                                    
                                    <div class="info-box bg-success">
                                        <span class="info-box-icon"><i class="fas fa-hdd"></i></span>
                                        <div class="info-box-content">
                                            <span class="info-box-text">File Size</span>
                                            <span class="info-box-number">
                                                {% if dataset.file_size_bytes %}
                                                    {{ dataset.file_size_bytes|filesizeformat }}
                                                {% else %}
                                                    Unknown
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Actions -->
                            <div class="card">
                                <div class="card-header">
                                    <h5>Actions</h5>
                                </div>
                                <div class="card-body">
                                    {% if dataset.status == 'ready' %}
                                    <a href="{% url 'dataset_manager:dataset_samples' dataset_id=dataset.id %}" class="btn btn-primary btn-block mb-2">
                                        <i class="fas fa-eye"></i> View Samples
                                    </a>
                                    <a href="{% url 'dataset_manager:dataset_preview' dataset_id=dataset.id %}" class="btn btn-info btn-block mb-2">
                                        <i class="fas fa-search"></i> Preview Data
                                    </a>
                                    {% endif %}
                                    
                                    {% if dataset.created_by == request.user %}
                                    <a href="{% url 'dataset_manager:dataset_edit' dataset_id=dataset.id %}" class="btn btn-warning btn-block mb-2">
                                        <i class="fas fa-edit"></i> Edit Dataset
                                    </a>
                                    <a href="{% url 'dataset_manager:dataset_delete' dataset_id=dataset.id %}" class="btn btn-danger btn-block" 
                                       onclick="return confirm('Are you sure you want to delete this dataset?')">
                                        <i class="fas fa-trash"></i> Delete Dataset
                                    </a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
